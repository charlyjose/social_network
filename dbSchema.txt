Schema
------

--
--  TABLE STRUCTURE FOR `sn`
--



CREATE database sn;
use sn;

###################################################################
CREATE USER 'user'@'localhost' IDENTIFIED BY '*******';
GRANT ALL PRIVILEGES ON vyapti19 . * TO 'user'@'localhost';
mysql -u root -p sn < sn.sql
FLUSH PRIVILEGES;
###################################################################



# TABLE 1 user

CREATE TABLE IF NOT EXISTS `user` (
    `name` varchar(30) NOT NULL,
    `uname` varchar(30) NOT NULL UNIQUE,
    `email` varchar(50) NOT NULL UNIQUE,
    `password` varchar(20) NOT NULL,
    `collegeID` varchar(10) NOT NULL PRIMARY KEY,
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `edit_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


# TABLE 2 auth
 
CREATE TABLE IF NOT EXISTS `auth` (
    `email` varchar(50) NOT NULL PRIMARY KEY,
    `session` char(64)  NOT NULL UNIQUE,
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


# TABLE 3 posts

CREATE TABLE IF NOT EXISTS `posts` (
    `postid` int PRIMARY KEY AUTO_INCREMENT NOT NULL,
    `collegeID` varchar(10) NOT NULL,
    `parent` varchar(10) NOT NULL,
    `likes` int,
    `views` int,
    `shares` int,
    `edit`  tinyint(1),
    `data` tinyint(1) DEFAULT 0,
    `postTitle` varchar(100) NOT NULL,
    `postBody` MEDIUMTEXT  NOT NULL,
    `imageFile` varchar(200) DEFAULT NULL,
    `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `edit_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

ALTER TABLE posts AUTO_INCREMENT=100;



# TABLE 2 address

CREATE TABLE IF NOT EXISTS `address` (
    `collegeID` varchar(10) NOT NULL,
    `addressline1` varchar(30) NOT NULL,
    `addressline2` varchar(30) NOT NULL,
    `city` varchar(30) NOT NULL,
    `country` varchar(30) NOT NULL,    
    `zip` varchar(10) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

insert into address (collegeID, addressline1, addressline2, city, country, zip) values("MUT16CS001", "Karimugal", "Karimugal PO", "Ernakulam", "IN","682303");
insert into address (collegeID, addressline1, addressline2, city, country, zip) values("MUT16CS020", "Koothattukulam", "Koothattukulam PO", "Ernakulam", "IN","682569");

update user set password = req.body.passwordnew where session = req.session.email




## data = 0 ---> ERROR
## data = 1 ---> text
## data = 2 ---> image
## data = 3 ---> video
## data = 4 ---> image with text










# TABLE 5 transaction

CREATE TABLE `transaction` (
  `tid` int(11) NOT NULL AUTO_INCREMENT,
  `pid` int(11) NOT NULL,
  `cid` char(15) NOT NULL,
  `ehid` char(5) NOT NULL,
  `withdraw` tinyint(1) NOT NULL DEFAULT 0,
  `deposit` tinyint(1) NOT NULL DEFAULT 0,
  `amount` smallint(4) NOT NULL DEFAULT 0,
  `time` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`tid`)
) ENGINE=InnoDB AUTO_INCREMENT=11500 DEFAULT CHARSET=utf8;
